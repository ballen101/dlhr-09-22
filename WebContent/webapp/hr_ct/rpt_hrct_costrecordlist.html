<!DOCTYPE html><html workpath="webapp/hr_ct"><head lang="zh"><meta charset="UTF-8"><link rel="stylesheet" type="text/css" href="../js/easyui/themes/default/easyui.css"><link rel="stylesheet" type="text/css" href="../js/easyui/themes/icon.css"><link rel="stylesheet" type="text/css" href="../js/css/corsair.css"><link rel="stylesheet" type="text/css" href="../style/jquery.jOrgChart.css"><link rel="stylesheet" type="text/css" href="../style/custom.css"><script type="text/javascript" src="../js/easyui/jquery.min.js"></script><script type="text/javascript" src="../js/easyui/jquery.easyui.min.js"></script><script type="text/javascript" src="../js/easyui/easyloader.js"></script><!--[if lte IE 8]><script language="javascript" type="text/javascript" src="../js/flot/excanvas.min.js"></script><![endif]--><script type="text/javascript" src="../js/flot/jquery.flot.js"></script><script type="text/javascript" src="../js/flot/jquery.flot.pie.js"></script><script type="text/javascript" src="../js/flot/jquery.flot.axislabels.js"></script><script type="text/javascript" src="../js/flot/jquery.flot.stack.js"></script><script type="text/javascript" src="../js/flot/jshashtable-2.1.js"></script><script type="text/javascript" src="../js/flot/jquery.numberformatter-1.2.3.min.js"></script><script type="text/javascript" src="../js/flot/jquery.flot.time.js"></script><script type="text/javascript" src="../js/flot/jquery.flot.symbol.js"></script><script type="text/javascript" src="../js/flot/jquery.flot.resize.js"></script><script type="text/javascript" src="../js/cjquery.min.js"></script><script type="text/javascript" src="../js/icefall.min.js"></script><script type="text/javascript" src="../js/common/jsonbanding2.js"></script><script type="text/javascript" src="../js/common/cSearchDlg.min.js"></script><script type="text/javascript" src="../js/common/cFindDlg.min.js"></script><script type="text/javascript" src="../js/common/creport.js"></script><title></title><script type="text/javascript" style="cserver_js"> var comUrl_dic923 = {index: 'dic923',type: 'combobox',valueField: 'dictvalue',textField: 'language1',jsondata:[{"language1":"平时加班","dictvalue":"1"},{"language1":"休息日加班","dictvalue":"2"},{"language1":"法定假日加班","dictvalue":"3"},{"language1":"特殊加班日","dictvalue":"4"}], formator: function (value, row) { var jsondata = comUrl_dic923.jsondata; if (value == 'get_com_data') { return jsondata; } if (value == 'get_com_url') { return comUrl_dic923; } if (comUrl_dic923.type == 'combobox') { for (var i = 0; i < jsondata.length; i++) { if (value == jsondata[i][comUrl_dic923.valueField]) return jsondata[i][comUrl_dic923.textField]; } } if (comUrl_dic923.type == 'combotree') { var txt = $getTreeTextById(jsondata, value); if (txt == undefined) txt = value; return txt; } return value; } }; comUrl_dic923.editor= {type: 'combobox', options: {valueField:comUrl_dic923.valueField, textField:comUrl_dic923.textField, data: comUrl_dic923.jsondata}}; var comUrl_dic928 = {index: 'dic928',type: 'combobox',valueField: 'dictvalue',textField: 'language1',jsondata:[{"language1":"调休","dictvalue":"1"},{"language1":"计算加班费","dictvalue":"2"}], formator: function (value, row) { var jsondata = comUrl_dic928.jsondata; if (value == 'get_com_data') { return jsondata; } if (value == 'get_com_url') { return comUrl_dic928; } if (comUrl_dic928.type == 'combobox') { for (var i = 0; i < jsondata.length; i++) { if (value == jsondata[i][comUrl_dic928.valueField]) return jsondata[i][comUrl_dic928.textField]; } } if (comUrl_dic928.type == 'combotree') { var txt = $getTreeTextById(jsondata, value); if (txt == undefined) txt = value; return txt; } return value; } }; comUrl_dic928.editor= {type: 'combobox', options: {valueField:comUrl_dic928.valueField, textField:comUrl_dic928.textField, data: comUrl_dic928.jsondata}}; var comUrls = [ { index: "dic923", type: "combobox", url: "/web/dict/getdictvalues.co?dicid=923", valueField: 'dictvalue', textField: 'language1' }, { index: "dic928", type: "combobox", url: "/web/dict/getdictvalues.co?dicid=928", valueField: 'dictvalue', textField: 'language1' } ];</script> <script type="text/javascript"> comUrl_dic923.formator = function (value, row) { var jsondata = comUrl_dic923.jsondata; if (value == 'get_com_data') { return jsondata; } if (value == 'get_com_url') { return comUrl_dic923; } var arv = eval("[" + value + "]"); var rv = ""; for (var i = 0; i < arv.length; i++) { for (var j = 0; j < jsondata.length; j++) { if (arv[i] == jsondata[j]["dictvalue"]) { rv = rv + jsondata[j]["language1"] + ","; break; } } } if (rv.length > 0) rv = rv.substring(0, rv.length - 1); if (rv.length > 0) return rv; else return value; }; var orgfdiptions = { easyui_class: 'easyui-textbox', editable: false, icons: [ { iconCls: 'icon-search', handler: function (e) { onSelectOrg(e); } } ] }; var listGridColumns = function () { return [ {field:'cardnumber',title:'卡号',width:80}, {field: 'employee_code', title: '工号', width: 100}, {field: 'employee_name', title: '姓名', width: 80}, {field:'orgname',title:'部门',width:120}, {field:'sp_name',title:'职位',width:120}, {field:'lv_num',title:'职级',width:64}, {field:'ctr_name',title:'用餐餐厅',width:100}, {field:'ctcr_code',title:'卡机编号',width:80}, {field:'ctcr_name',title:'卡机名',width:80}, {field:'costtime',title:'刷卡时间',width:100}, {field:'mc_name',title:'餐类',width:64}, {field:'price',title:'餐标',width:64}, {field:'compay',title:'公司支付',width:64}, {field:'cost',title:'个人支付',width:64}, {field:'subsidies',title:'补贴金额',width:64}, {field: 'remark', title: '备注', width: 100} ] }; var relOptions = { data: [{id: '=', value: '等于'}] }; var findColums = [ {field: 'orgcode', title: '机构编码', notnull: true, relOptions: relOptions, cjoptions: orgfdiptions, width: 100}, {field: 'employee_code', title: '工号',  width: 100}, {field: 'costtime', title: '刷卡时间', notnull: true, relOptions: relOptions, formatter: $fieldDateFormatorYYYY_MM_DD, width: 100} ]; var prtOptions = { htmlTempt: "", gdListColumns: listGridColumns, findExtParms: findColums, coURL: _serUrl + "/web/hrct/costrecord/findcostrecordday.co", extButtons: [ { text: '导入消费记录', iconCls: 'icon-importexcel', handler: function () { impcostrecords(); } } ] }; var select_Org_pw = undefined; function onSelectOrg(event) { var url = _serUrl + "/web/user/getOrgsByLged.co?type=gridtree"; var wo = { id: "select_Org_pw", coURL: url, orderStr: " orgid asc ", multiRow: false, isTree: true, idField: 'orgid', pidField: 'superid', treeField: 'code', showTitle: false, extParms: [ {parmname: 'stat', reloper: '=', parmvalue: '1'} ], width: "500px", height: "400px", gdListColumns: [ {field: 'code', title: '编码', width: 120}, {field: 'orgname', title: '机构', width: 100} ] }; if (!select_Org_pw) { select_Org_pw = new TSearchForm(wo); } select_Org_pw.extendOptions({ onResult: function (rows) { if (rows.length > 0) { var row = rows[0]; $(event.data.target).textbox('setValue', row.code); } } }); select_Org_pw.show(); } function impcostrecords(){ var ccurl = _serUrl + "/web/hrct/costrecord/syncCostrecords.co?" ; $ajaxjsonget(ccurl, function (jsondata) { if (jsondata.result == "OK") { $.messager.alert('提示', '成功导入消费记录!', 'info'); } }, function (err) { alert(JSON.stringify(err)); }); } function jbtimeformator(value, row, index) { if ((!value) || (value.length == 0)) return value; var dt = (new Date()).fromStr(value); return dt.format("yyyy-MM-dd hh:mm:ss"); } </script> </head><body></body></html>