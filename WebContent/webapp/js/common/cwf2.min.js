function jsDraw2DX(){}jsDraw2DX._RefID=0;jsDraw2DX._isVML=!1;jsDraw2DX.checkIE=function(){if("Microsoft Internet Explorer"==navigator.appName){var e=9;-1!=navigator.appVersion.indexOf("MSIE")&&(e=parseFloat(navigator.appVersion.split("MSIE")[1]));9>e&&(jsDraw2DX._isVML=!0)}};jsDraw2DX.fact=function(e){for(var k=1,m=1;m<=e;m++)k*=m;return k};
jsDraw2DX.init=function(){jsDraw2DX.checkIE();if(jsDraw2DX._isVML){document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML");for(var e=["fill","stroke","path","textpath"],k=0,m=e.length;k<m;k++)document.createStyleSheet().addRule("v\\:"+e[k],"behavior: url(#default#VML);")}};jsDraw2DX.init();
function jxGraphics(e){this.origin=new jxPoint(0,0);this.scale=1;this.coordinateSystem="default";var k=[],m,a,c,b;e?(m=e,m.style.overflow="hidden"):m=document.body;jsDraw2DX._isVML?(c=document.createElement("v:group"),c.style.position="absolute",c.style.top="0px",c.style.left="0px",m.appendChild(c)):(a=document.createElementNS("http://www.w3.org/2000/svg","svg"),m.appendChild(a),b=document.createElementNS("http://www.w3.org/2000/svg","defs"),a.appendChild(b),a.style.position="absolute",a.style.top=
    "0px",a.style.left="0px",a.style.width=m.style.width,a.style.height=m.style.height);this.getDefs=function(){return b};this.addShape=function(b){0>this.indexOfShape(b)&&k.push(b)};this.removeShape=function(b){b=this.indexOfShape(b);0<=b&&k.splice(b,1)};this.getType=function(){return"jxGraphics"};this.getDiv=function(){return m};this.getSVG=function(){return a};this.getVML=function(){return c};this.logicalToPhysicalPoint=function(b){return"cartecian"==this.coordinateSystem.toLowerCase()?new jxPoint(Math.round(b.x*
    this.scale+this.origin.x),Math.round(this.origin.y-b.y*this.scale)):new jxPoint(Math.round(b.x*this.scale+this.origin.x),Math.round(b.y*this.scale+this.origin.y))};this.draw=function(b){return b.draw(this)};this.remove=function(b){return b.remove(this)};this.removeall=function(){for(var b=k.length-1;0<=b;b--)this.remove(k[b])};this.redrawAll=function(){for(ind in k)k[ind].draw(this)};this.getShapesCount=function(){return k.length};this.getShape=function(b){return k[b]};this.indexOfShape=function(b){for(var d=
    -1,l=k.length,c=0;c<l;c++)b==k[c]&&(d=c);return d}}function jxColor(){var e="#000000";switch(arguments.length){case 1:e=arguments[0];break;case 3:e=jxColor.rgbToHex(arguments[0],arguments[1],arguments[2])}this.getType=function(){return"jxColor"};this.getValue=function(){return e}}jxColor.rgbToHex=function(e,k,m){if(0>e||255<e||0>k||255<k||0>m||255<m)return!1;for(e=(Math.round(m)+256*Math.round(k)+65536*Math.round(e)).toString(16)+"";6>e.length;)e="0"+e;return"#"+e};
jxColor.hexToRgb=function(e){var k,m;"#"==e.charAt(0)&&(e=e.substring(1,7));k=parseInt(e.substring(0,2),16);m=parseInt(e.substring(2,4),16);e=parseInt(e.substring(4,6),16);return 0>k||255<k||0>m||255<m||0>e||255<e?!1:[k,m,e]};
function jxFont(e,k,m,a,c){this.variant=this.weight=this.style=this.size=this.family=null;e&&(this.family=e);a&&(this.weight=a);k&&(this.size=k);m&&(this.style=m);c&&(this.variant=c);this.updateSVG=function(b){this.family?b.setAttribute("font-family",this.family):b.setAttribute("font-family","");this.weight?b.setAttribute("font-weight",this.weight):b.setAttribute("font-weight","");this.size?b.setAttribute("font-size",this.size):b.setAttribute("font-size","");this.style?b.setAttribute("font-style",
    this.style):b.setAttribute("font-style","");this.variant?b.setAttribute("font-variant",this.variant):b.setAttribute("font-variant","")};this.updateVML=function(b){b.style.fontFamily=this.family?"'"+this.family+"'":"";b.style.fontWeight=this.weight?this.weight:"";b.style.fontSize=this.size?this.size:"";b.style.fontStyle=this.style?this.style:"";b.style.fontVariant=this.variant?this.variant:""};this.getType=function(){return"jxFont"}}
jxFont.updateSVG=function(e){e.setAttribute("font-family","");e.setAttribute("font-weight","");e.setAttribute("font-size","");e.setAttribute("font-style","");e.setAttribute("font-variant","")};jxFont.updateVML=function(e){e.style.fontFamily="";e.style.fontWeight="";e.style.fontSize="";e.style.fontStyle="";e.style.fontVariant=""};
function jxPen(e,k,m){this.dashStyle=this.width=this.color=null;this.color=e?e:new jxColor("#000000");this.width=k?k:"1px";m&&(this.dashStyle=m);this.updateSVG=function(a){a.setAttribute("stroke",this.color.getValue());a.setAttribute("stroke-width",this.width);if(this.dashStyle){var c=parseInt(this.width);switch(this.dashStyle.toLowerCase()){case "shortdash":a.setAttribute("stroke-dasharray",3*c+" "+c);break;case "shortdot":a.setAttribute("stroke-dasharray",c+" "+c);break;case "shortdashdot":a.setAttribute("stroke-dasharray",
    3*c+" "+c+" "+c+" "+c);break;case "shortdashdotdot":a.setAttribute("stroke-dasharray",3*c+" "+c+" "+c+" "+c+" "+c+" "+c);break;case "dot":a.setAttribute("stroke-dasharray",c+" "+3*c);break;case "dash":a.setAttribute("stroke-dasharray",4*c+" "+3*c);break;case "longdash":a.setAttribute("stroke-dasharray",8*c+" "+3*c);break;case "dashdot":a.setAttribute("stroke-dasharray",4*c+" "+3*c+" "+c+" "+3*c);break;case "longdashdot":a.setAttribute("stroke-dasharray",8*c+" "+3*c+" "+c+" "+3*c);break;case "longdashdotdot":a.setAttribute("stroke-dasharray",
    8*c+" "+3*c+" "+c+" "+3*c+" "+c+" "+3*c);break;default:a.setAttribute("stroke-dasharray",this.dashStyle)}}};this.updateVML=function(a){a.Stroke.JoinStyle="miter";a.Stroke.MiterLimit="5";a.StrokeColor=this.color.getValue();a.StrokeWeight=this.width;this.dashStyle&&(a.Stroke.DashStyle=this.dashStyle);0==parseInt(this.width)&&(a.Stroked="False")};this.getType=function(){return"jxPen"}}
function jxBrush(e,k){this.angle=this.color2=this.fillType=this.color=null;this.color=e?e:new jxColor("#000000");this.fillType=k?k:"solid";this.color2=new jxColor("#FFFFFF");this.updateSVG=function(e,a){var c,b;if(c=e.getAttribute("fill"))"url(#"==c.substr(0,5)?(c=c.substr(5,c.length-6),b=document.getElementById(c)):c=null;if("linear-gradient"==this.fillType||"lin-grad"==this.fillType){var f=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c?a.replaceChild(f,b):a.appendChild(f);
    a=document.createElementNS("http://www.w3.org/2000/svg","stop");f.appendChild(a);c=document.createElementNS("http://www.w3.org/2000/svg","stop");f.appendChild(c);jsDraw2DX._RefID++;f.setAttribute("id","jsDraw2DX_RefID_"+jsDraw2DX._RefID);null!=this.angle?f.setAttribute("gradientTransform","rotate("+this.angle+" 0.5 0.5)"):f.setAttribute("gradientTransform","rotate(0 0.5 0.5)");a.setAttribute("offset","0%");a.setAttribute("style","stop-color:"+this.color.getValue()+";stop-opacity:1");c.setAttribute("offset",
        "100%");c.setAttribute("style","stop-color:"+this.color2.getValue()+";stop-opacity:1");f.appendChild(a);f.appendChild(c);e.setAttribute("fill","url(#jsDraw2DX_RefID_"+jsDraw2DX._RefID+")")}else e.setAttribute("fill",this.color.getValue())};this.updateVML=function(e){e.On="true";"solid"==this.fillType?(e.Type="solid",e.Color=this.color.getValue(),e.Color2="",e.Angle=270):(e.Type="gradient",e.Angle=null!=this.angle?270-this.angle:270,e.Color=this.color.getValue(),e.Color2=this.color2.getValue())};this.getType=
    function(){return"jxBrush"}}function jxPoint(e,k){this.x=e;this.y=k;this.getType=function(){return"jxPoint"}}
function jxLine(e,k,m){this.fromPoint=e;this.toPoint=k;this.pen=null;var a,c=!0,b;m&&(this.pen=m);a=jsDraw2DX._isVML?document.createElement("v:line"):document.createElementNS("http://www.w3.org/2000/svg","line");this.getType=function(){return"jxLine"};this.addEventListener=function(b,d){function l(b){d(b,c)}a.addEventListener?a.addEventListener(b,l,!1):a.attachEvent&&a.attachEvent("on"+b,l);var c=this};this.draw=function(f){var d,l;d=f.logicalToPhysicalPoint(this.fromPoint);l=f.logicalToPhysicalPoint(this.toPoint);
    this.pen.color.getValue();var p,w;p=d.x;d=d.y;w=l.x;l=l.y;a.style.display="none";if(jsDraw2DX._isVML){var B=f.getVML();c&&(B.appendChild(a),c=!1);this.pen?this.pen.updateVML(a):a.Stroked="False";a.style.position="absolute";a.From=p+","+d;a.To=w+","+l}else B=f.getSVG(),c&&(B.appendChild(a),c=!1),this.pen?this.pen.updateSVG(a):a.setAttribute("stroke","none"),a.setAttribute("x1",p),a.setAttribute("y1",d),a.setAttribute("x2",w),a.setAttribute("y2",l);a.style.display="";b&&f!=b&&b.removeShape(this);b=
        f;b.addShape(this)};this.remove=function(){b&&(jsDraw2DX._isVML?b.getVML().removeChild(a):b.getSVG().removeChild(a),b.removeShape(this),b=null,c=!0)};this.show=function(){a.style.display=""};this.hide=function(){a.style.display="none"}}
function jxRect(e,k,m,a,c){this.point=e;this.width=k;this.height=m;this.brush=this.pen=null;var b,f=!0,d;this.getElement=function(){return b};a&&(this.pen=a);c&&(this.brush=c);b=jsDraw2DX._isVML?document.createElement("v:rect"):document.createElementNS("http://www.w3.org/2000/svg","rect");this.getType=function(){return"jxRect"};this.addEventListener=function(d,c){function l(d){c(d,a)}b.addEventListener?b.addEventListener(d,l,!1):b.attachEvent&&b.attachEvent("on"+d,l);var a=this};this.draw=function(l){var c,
    a;c=l.logicalToPhysicalPoint(this.point);a=l.scale;var B;B=c.x;c=c.y;b.style.display="none";if(jsDraw2DX._isVML){var e=l.getVML();f&&(e.appendChild(b),f=!1);this.pen?this.pen.updateVML(b):b.Stroked="False";e=b.fill;this.brush?this.brush.updateVML(e):e.On="false";b.style.width=a*this.width;b.style.height=a*this.height;b.style.position="absolute";b.style.top=c;b.style.left=B}else e=l.getSVG(),f&&(e.appendChild(b),f=!1),this.pen?this.pen.updateSVG(b):b.setAttribute("stroke","none"),this.brush?this.brush.updateSVG(b,
    l.getDefs()):b.setAttribute("fill","none"),b.setAttribute("x",B),b.setAttribute("y",c),b.setAttribute("width",a*this.width),b.setAttribute("height",a*this.height),b.style.position="absolute";b.style.display="";d&&l!=d&&d.removeShape(this);d=l;d.addShape(this)};this.remove=function(){d&&(jsDraw2DX._isVML?d.getVML().removeChild(b):d.getSVG().removeChild(b),d.removeShape(this),d=null,f=!0)};this.show=function(){b.style.display=""};this.hide=function(){b.style.display="none"}}
function jxPolyline(e,k,m){this.points=e;this.brush=this.pen=null;var a,c=!0,b;k&&(this.pen=k);m&&(this.brush=m);a=jsDraw2DX._isVML?document.createElement("v:polyline"):document.createElementNS("http://www.w3.org/2000/svg","polyline");this.getType=function(){return"jxPolyline"};this.getElement=function(){return a};this.addEventListener=function(b,d){function l(b){d(b,c)}a.addEventListener?a.addEventListener(b,l,!1):a.attachEvent&&a.attachEvent("on"+b,l);var c=this};this.draw=function(f){var d=[],
    l="";for(ind in this.points)d[ind]=f.logicalToPhysicalPoint(this.points[ind]);for(ind in d)l=l+d[ind].x+","+d[ind].y+" ";a.style.display="none";jsDraw2DX._isVML?(d=f.getVML(),c&&(d.appendChild(a),c=!1),this.pen?this.pen.updateVML(a):a.Stroked="False",d=a.fill,this.brush?this.brush.updateVML(d):d.On="false",a.style.position="absolute",a.Points.Value=l):(d=f.getSVG(),c&&(d.appendChild(a),c=!1),this.pen?this.pen.updateSVG(a):a.setAttribute("stroke","none"),this.brush?this.brush.updateSVG(a,f.getDefs()):
    a.setAttribute("fill","none"),a.style.position="absolute",a.setAttribute("points",l));a.style.display="";b&&f!=b&&b.removeShape(this);b=f;b.addShape(this)};this.remove=function(){b&&(jsDraw2DX._isVML?b.getVML().removeChild(a):b.getSVG().removeChild(a),b.removeShape(this),b=null,c=!0)};this.show=function(){a.style.display=""};this.hide=function(){a.style.display="none"}}
function jxPolygon(e,k,m){this.points=e;this.brush=this.pen=null;var a,c=!0,b;k&&(this.pen=k);m&&(this.brush=m);a=jsDraw2DX._isVML?document.createElement("v:polyline"):document.createElementNS("http://www.w3.org/2000/svg","polygon");this.getType=function(){return"jxPolygon"};this.getElement=function(){return a};this.addEventListener=function(b,d){function l(b){d(b,c)}a.addEventListener?a.addEventListener(b,l,!1):a.attachEvent&&a.attachEvent("on"+b,l);var c=this};this.draw=function(f){var d=[],l="";
    for(ind in this.points)d[ind]=f.logicalToPhysicalPoint(this.points[ind]);for(ind in d)l=l+d[ind].x+","+d[ind].y+" ";a.style.display="none";jsDraw2DX._isVML?(l=l+d[0].x+","+d[0].y,d=f.getVML(),c&&(d.appendChild(a),c=!1),this.pen?this.pen.updateVML(a):a.Stroked="False",d=a.fill,this.brush?this.brush.updateVML(d):d.On="false",a.style.position="absolute",a.Points.Value=l):(d=f.getSVG(),c&&(d.appendChild(a),c=!1),this.pen?this.pen.updateSVG(a):a.setAttribute("stroke","none"),this.brush?this.brush.updateSVG(a,
        f.getDefs()):a.setAttribute("fill","none"),a.style.position="absolute",a.setAttribute("points",l));a.style.display="";b&&f!=b&&b.removeShape(this);b=f;b.addShape(this)};this.remove=function(){b&&(jsDraw2DX._isVML?b.getVML().removeChild(a):b.getSVG().removeChild(a),b.removeShape(this),b=null,c=!0)};this.show=function(){a.style.display=""};this.hide=function(){a.style.display="none"}}
function jxCircle(e,k,m,a){this.center=e;this.radius=k;this.brush=this.pen=null;var c,b=!0,f;m&&(this.pen=m);a&&(this.brush=a);c=jsDraw2DX._isVML?document.createElement("v:oval"):document.createElementNS("http://www.w3.org/2000/svg","circle");this.getType=function(){return"jxCircle"};this.addEventListener=function(d,b){function l(d){b(d,a)}c.addEventListener?c.addEventListener(d,l,!1):c.attachEvent&&c.attachEvent("on"+d,l);var a=this};this.draw=function(d){var l,a;l=d.logicalToPhysicalPoint(this.center);
    a=d.scale;var e;e=l.x;l=l.y;c.style.display="none";if(jsDraw2DX._isVML){var B=d.getVML();b&&(B.appendChild(c),b=!1);this.pen?this.pen.updateVML(c):c.Stroked="False";B=c.fill;this.brush?this.brush.updateVML(B):B.On="false";c.style.width=a*this.radius*2;c.style.height=a*this.radius*2;c.style.position="absolute";c.style.top=l-a*this.radius;c.style.left=e-a*this.radius}else B=d.getSVG(),b&&(B.appendChild(c),b=!1),this.pen?this.pen.updateSVG(c):c.setAttribute("stroke","none"),this.brush?this.brush.updateSVG(c,
        d.getDefs()):c.setAttribute("fill","none"),c.setAttribute("cx",e),c.setAttribute("cy",l),c.setAttribute("r",a*this.radius),c.style.position="absolute";c.style.display="";f&&d!=f&&f.removeShape(this);f=d;f.addShape(this)};this.remove=function(){f&&(jsDraw2DX._isVML?f.getVML().removeChild(c):f.getSVG().removeChild(c),f.removeShape(this),f=null,b=!0)};this.show=function(){c.style.display=""};this.hide=function(){c.style.display="none"}}
function jxEllipse(e,k,m,a,c){this.center=e;this.width=k;this.height=m;this.brush=this.pen=null;var b,f=!0,d;a&&(this.pen=a);c&&(this.brush=c);b=jsDraw2DX._isVML?document.createElement("v:oval"):document.createElementNS("http://www.w3.org/2000/svg","ellipse");this.getType=function(){return"jxEllipse"};this.addEventListener=function(d,c){function l(d){c(d,a)}b.addEventListener?b.addEventListener(d,l,!1):b.attachEvent&&b.attachEvent("on"+d,l);var a=this};this.draw=function(l){var c,a;c=l.logicalToPhysicalPoint(this.center);
    a=l.scale;var e;e=c.x;c=c.y;b.style.display="none";if(jsDraw2DX._isVML){var v=l.getVML();f&&(v.appendChild(b),f=!1);this.pen?this.pen.updateVML(b):b.Stroked="False";v=b.fill;this.brush?this.brush.updateVML(v):v.On="false";b.style.width=a*this.width;b.style.height=a*this.height;b.style.position="absolute";b.style.top=c-a*this.height/2;b.style.left=e-a*this.width/2}else v=l.getSVG(),f&&(v.appendChild(b),f=!1),this.pen?this.pen.updateSVG(b):b.setAttribute("stroke","none"),this.brush?this.brush.updateSVG(b,
        l.getDefs()):b.setAttribute("fill","none"),b.setAttribute("cx",e),b.setAttribute("cy",c),b.setAttribute("rx",a*this.width/2),b.setAttribute("ry",a*this.height/2),b.style.position="absolute";b.style.display="";d&&l!=d&&d.removeShape(this);d=l;d.addShape(this)};this.remove=function(){d&&(jsDraw2DX._isVML?d.getVML().removeChild(b):d.getSVG().removeChild(b),d.removeShape(this),d=null,f=!0)};this.show=function(){b.style.display=""};this.hide=function(){b.style.display="none"}}
function jxArc(e,k,m,a,c,b,f){this.center=e;this.width=k;this.height=m;this.startAngle=a;this.arcAngle=c;this.brush=this.pen=null;var d,l=!0,p;b&&(this.pen=b);f&&(this.brush=f);d=jsDraw2DX._isVML?document.createElement("v:arc"):document.createElementNS("http://www.w3.org/2000/svg","path");this.getType=function(){return"jxArc"};this.addEventListener=function(b,c){function l(d){c(d,a)}d.addEventListener?d.addEventListener(b,l,!1):d.attachEvent&&d.attachEvent("on"+b,l);var a=this};this.draw=function(b){var f;
    b.logicalToPhysicalPoint(b);f=b.scale;var e,n;e=this.center.x;n=this.center.y;d.style.display="none";if(jsDraw2DX._isVML){var g=b.getVML(),h;l&&(g.appendChild(d),l=!1);var w,k;k=this.startAngle+this.arcAngle;a=this.startAngle%360;k%=360;g=f*this.width/2;h=f*this.height/2;q=this.startAngle*Math.PI/180;m=g*h/Math.sqrt(h*h*Math.cos(q)*Math.cos(q)+g*g*Math.sin(q)*Math.sin(q));w=180*Math.asin(m*Math.sin(q)/h)/Math.PI;270<this.startAngle?w=360+w:90<this.startAngle&&(w=180-w);q=k*Math.PI/180;m=g*h/Math.sqrt(h*
            h*Math.cos(q)*Math.cos(q)+g*g*Math.sin(q)*Math.sin(q));g=180*Math.asin(m*Math.sin(q)/h)/Math.PI;270<k?g=360+g:90<k&&(g=180-g);this.pen?this.pen.updateVML(d):d.Stroked="False";h=d.fill;this.brush?this.brush.updateVML(h):h.On="false";d.style.width=f*this.width;d.style.height=f*this.height;d.style.position="absolute";d.style.left=e-f*this.width/2;d.style.top=n-f*this.height/2;w+=90;d.StartAngle=360<w?w%360:w;g+=90;360<g?(360>=w&&(d.StartAngle=w-360),d.EndAngle=g%360):d.EndAngle=g}else{var m,q,g=f*this.width/
        2;h=f*this.height/2;q=this.startAngle*Math.PI/180;m=g*h/Math.sqrt(h*h*Math.cos(q)*Math.cos(q)+g*g*Math.sin(q)*Math.sin(q));f=m*Math.cos(q);w=m*Math.sin(q);f=e+f;w=n+w;q=(a+c)*Math.PI/180;m=g*h/Math.sqrt(h*h*Math.cos(q)*Math.cos(q)+g*g*Math.sin(q)*Math.sin(q));k=m*Math.cos(q);m*=Math.sin(q);k=e+k;m=n+m;e=b.getSVG();l&&(e.appendChild(d),l=!1);this.pen?this.pen.updateSVG(d):d.setAttribute("stroke","none");this.brush?this.brush.updateSVG(d,b.getDefs()):d.setAttribute("fill","none");180<c?d.setAttribute("d",
        "M"+f+" "+w+" A"+g+" "+h+" 0 1 1 "+k+" "+m):d.setAttribute("d","M"+f+" "+w+" A"+g+" "+h+" 0 0 1 "+k+" "+m)}d.style.display="";p&&b!=p&&p.removeShape(this);p=b;p.addShape(this)};this.remove=function(){p&&(jsDraw2DX._isVML?p.getVML().removeChild(d):p.getSVG().removeChild(d),p.removeShape(this),p=null,l=!0)};this.show=function(){d.style.display=""};this.hide=function(){d.style.display="none"}}
function jxArcSector(e,k,m,a,c,b,f){this.center=e;this.width=k;this.height=m;this.startAngle=a;this.arcAngle=c;this.brush=this.pen=null;var d,l=!0,p;b&&(this.pen=b);f&&(this.brush=f);d=jsDraw2DX._isVML?document.createElement("v:shape"):document.createElementNS("http://www.w3.org/2000/svg","path");this.getType=function(){return"jxArcSector"};this.addEventListener=function(b,c){function l(d){c(d,a)}d.addEventListener?d.addEventListener(b,l,!1):d.attachEvent&&d.attachEvent("on"+b,l);var a=this};this.draw=
    function(b){var a,f;a=b.logicalToPhysicalPoint(this.center);f=b.scale;var e;e=a.x;a=a.y;var g,h,k,w,m,q;g=f*this.width/2;f=f*this.height/2;m=this.startAngle*Math.PI/180;h=g*f/Math.sqrt(f*f*Math.cos(m)*Math.cos(m)+g*g*Math.sin(m)*Math.sin(m));w=h*Math.cos(m);m=h*Math.sin(m);w=e+w;m=a+m;q=(this.startAngle+this.arcAngle)*Math.PI/180;k=g*f/Math.sqrt(f*f*Math.cos(q)*Math.cos(q)+g*g*Math.sin(q)*Math.sin(q));h=k*Math.cos(q);k*=Math.sin(q);h=e+h;k=a+k;d.style.display="none";jsDraw2DX._isVML?(q=b.getVML(),
    l&&(q.appendChild(d),l=!1),this.pen?this.pen.updateVML(d):d.Stroked="False",q=d.fill,this.brush?this.brush.updateVML(q):q.On="false",d.style.position="absolute",d.style.height=1,d.style.width=1,d.CoordSize="1 1",d.Path="M"+e+","+a+" AT"+(e-g)+","+(a-f)+","+(e+g)+","+(a+f)+","+Math.round(h)+","+Math.round(k)+","+Math.round(w)+","+Math.round(m)+" X E"):(q=b.getSVG(),l&&(q.appendChild(d),l=!1),this.pen?this.pen.updateSVG(d):d.setAttribute("stroke","none"),this.brush?this.brush.updateSVG(d,b.getDefs()):
        d.setAttribute("fill","none"),180<c?d.setAttribute("d","M"+e+" "+a+" L"+w+" "+m+" A"+g+" "+f+" 0 1 1 "+h+" "+k+" Z"):d.setAttribute("d","M"+e+" "+a+" L"+w+" "+m+" A"+g+" "+f+" 0 0 1 "+h+" "+k+" Z"));d.style.display="";p&&b!=p&&p.removeShape(this);p=b;p.addShape(this)};this.remove=function(){p&&(jsDraw2DX._isVML?p.getVML().removeChild(d):p.getSVG().removeChild(d),p.removeShape(this),p=null,l=!0)};this.show=function(){d.style.display=""};this.hide=function(){d.style.display="none"}}
function jxCurve(e,k,m,a){this.points=e;this.brush=this.pen=null;this.tension=1;var c,b=!0,f;k&&(this.pen=k);m&&(this.brush=m);null!=a&&(this.tension=a);c=jsDraw2DX._isVML?document.createElement("v:shape"):document.createElementNS("http://www.w3.org/2000/svg","path");this.getType=function(){return"jxCurve"};this.addEventListener=function(d,b){function a(d){b(d,l)}c.addEventListener?c.addEventListener(d,a,!1):c.attachEvent&&c.attachEvent("on"+d,a);var l=this};this.draw=function(d){var a=[];for(ind in this.points)a[ind]=
    d.logicalToPhysicalPoint(this.points[ind]);var e,m=this.tension,k=[],v=[],n=[],g;for(g in a)g=parseInt(g),k[g]=0==g?new jxPoint(m*(a[1].x-a[0].x)/2,m*(a[1].y-a[0].y)/2):g==a.length-1?new jxPoint(m*(a[g].x-a[g-1].x)/2,m*(a[g].y-a[g-1].y)/2):new jxPoint(m*(a[g+1].x-a[g-1].x)/2,m*(a[g+1].y-a[g-1].y)/2);for(g in a)g=parseInt(g),g==a.length-1?(v[g]=new jxPoint(a[g].x+k[g].x/3,a[g].y+k[g].y/3),n[g]=new jxPoint(a[g].x-k[g].x/3,a[g].y-k[g].y/3)):(v[g]=new jxPoint(a[g].x+k[g].x/3,a[g].y+k[g].y/3),n[g]=new jxPoint(a[g+
    1].x-k[g+1].x/3,a[g+1].y-k[g+1].y/3));for(g in a)g=parseInt(g),0==g&&(e="M"+a[g].x+","+a[g].y),g<a.length-1&&(e=e+" C"+Math.round(v[g].x)+","+Math.round(v[g].y)+","+Math.round(n[g].x)+","+Math.round(n[g].y)+","+Math.round(a[g+1].x)+","+Math.round(a[g+1].y));c.style.display="none";jsDraw2DX._isVML?(a=d.getVML(),b&&(a.appendChild(c),b=!1),this.pen?this.pen.updateVML(c):c.Stroked="False",a=c.fill,this.brush?this.brush.updateVML(a):a.On="false",c.style.position="absolute",c.style.width=1,c.style.height=
    1,c.CoordSize="1 1",c.Path=e+" E"):(a=d.getSVG(),b&&(a.appendChild(c),b=!1),this.pen?this.pen.updateSVG(c):c.setAttribute("stroke","none"),this.brush?this.brush.updateSVG(c,d.getDefs()):c.setAttribute("fill","none"),c.setAttribute("d",e));c.style.display="";f&&d!=f&&f.removeShape(this);f=d;f.addShape(this)};this.remove=function(){f&&(jsDraw2DX._isVML?f.getVML().removeChild(c):f.getSVG().removeChild(c),f.removeShape(this),f=null,b=!0)};this.show=function(){c.style.display=""};this.hide=function(){c.style.display=
    "none"}}
function jxClosedCurve(e,k,m,a){this.points=e;this.brush=this.pen=null;this.tension=1;var c,b=!0,f;c=null;k&&(this.pen=k);m&&(this.brush=m);null!=a&&(this.tension=a);c=jsDraw2DX._isVML?document.createElement("v:shape"):document.createElementNS("http://www.w3.org/2000/svg","path");this.getType=function(){return"jxClosedCurve"};this.addEventListener=function(d,b){function a(d){b(d,l)}c.addEventListener?c.addEventListener(d,a,!1):c.attachEvent&&c.attachEvent("on"+d,a);var l=this};this.draw=function(d){var a=[];
    for(ind in this.points)a[ind]=d.logicalToPhysicalPoint(this.points[ind]);var e,m=a.length-1,k=this.tension,v=[],n=[],g=[];for(i in a)i=parseInt(i),v[i]=0==i?new jxPoint(k*(a[1].x-a[m].x)/2,k*(a[1].y-a[m].y)/2):i==a.length-1?new jxPoint(k*(a[0].x-a[i-1].x)/2,k*(a[0].y-a[i-1].y)/2):new jxPoint(k*(a[i+1].x-a[i-1].x)/2,k*(a[i+1].y-a[i-1].y)/2);for(i in a)i=parseInt(i),i==a.length-1?(n[i]=new jxPoint(a[i].x+v[i].x/3,a[i].y+v[i].y/3),g[i]=new jxPoint(a[0].x-v[0].x/3,a[0].y-v[0].y/3)):(n[i]=new jxPoint(a[i].x+
        v[i].x/3,a[i].y+v[i].y/3),g[i]=new jxPoint(a[i+1].x-v[i+1].x/3,a[i+1].y-v[i+1].y/3));for(i in a)i=parseInt(i),0==i&&(e="M"+a[i].x+","+a[i].y),i<a.length-1&&(e=e+" C"+Math.round(n[i].x)+","+Math.round(n[i].y)+","+Math.round(g[i].x)+","+Math.round(g[i].y)+","+Math.round(a[i+1].x)+","+Math.round(a[i+1].y)),i==a.length-1&&(e=e+" C"+Math.round(n[i].x)+","+Math.round(n[i].y)+","+Math.round(g[i].x)+","+Math.round(g[i].y)+","+Math.round(a[0].x)+","+Math.round(a[0].y));c.style.display="none";jsDraw2DX._isVML?
        (a=d.getVML(),b&&(a.appendChild(c),b=!1),e+=" E",this.pen?this.pen.updateVML(c):c.Stroked="False",a=c.fill,this.brush?this.brush.updateVML(a):a.On="false",c.style.position="absolute",c.style.width=1,c.style.height=1,c.CoordSize="1 1",c.Path=e):(a=d.getSVG(),b&&(a.appendChild(c),b=!1),this.pen?this.pen.updateSVG(c):c.setAttribute("stroke","none"),this.brush?this.brush.updateSVG(c,d.getDefs()):c.setAttribute("fill","none"),c.setAttribute("d",e));c.style.display="";f&&d!=f&&f.removeShape(this);f=d;f.addShape(this)};
    this.remove=function(){f&&(jsDraw2DX._isVML?f.getVML().removeChild(c):f.getSVG().removeChild(c),f.removeShape(this),f=null,b=!0)};this.show=function(){c.style.display=""};this.hide=function(){c.style.display="none"}}
function jxBezier(e,k,m){this.points=e;this.brush=this.pen=null;var a,c=!0,b;k&&(this.pen=k);m&&(this.brush=m);a=jsDraw2DX._isVML?document.createElement("v:shape"):document.createElementNS("http://www.w3.org/2000/svg","path");this.getsvgvmlOjb=function(){return a};this.getType=function(){return"jxBezier"};this.addEventListener=function(b,d){function c(a){d(a,f)}a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c);var f=this};this.draw=function(f){var d=[];for(ind in this.points)d[ind]=
    f.logicalToPhysicalPoint(this.points[ind]);var e;if(4<d.length){var p=[],k=[],m=[],v=[],n=d.length-1,g,h,r,t,J=10*Math.min(1/Math.abs(d[n].x-d[0].x),1/Math.abs(d[n].y-d[0].y));for(t=r=0;1>t;t+=J){for(h=y=x=0;h<=n;h++){g=Math.pow(t,h)*Math.pow(1-t,n-h)*d[h].x;if(0!=h||h!=n)g=g*jsDraw2DX.fact(n)/jsDraw2DX.fact(h)/jsDraw2DX.fact(n-h);x+=g;g=Math.pow(t,h)*Math.pow(1-t,n-h)*d[h].y;if(0!=h||h!=n)g=g*jsDraw2DX.fact(n)/jsDraw2DX.fact(h)/jsDraw2DX.fact(n-h);y+=g}v[r]=new jxPoint(x,y);r++}v[r]=new jxPoint(d[n].x,
    d[n].y);d=v;tension=1;for(h in d)h=parseInt(h),p[h]=0==h?new jxPoint(tension*(d[1].x-d[0].x)/2,tension*(d[1].y-d[0].y)/2):h==d.length-1?new jxPoint(tension*(d[h].x-d[h-1].x)/2,tension*(d[h].y-d[h-1].y)/2):new jxPoint(tension*(d[h+1].x-d[h-1].x)/2,tension*(d[h+1].y-d[h-1].y)/2);for(h in d)h=parseInt(h),0==h?(k[h]=new jxPoint(d[0].x+p[0].x/3,d[0].y+p[0].y/3),m[h]=new jxPoint(d[1].x-p[1].x/3,d[1].y-p[1].y/3)):h==d.length-1?(k[h]=new jxPoint(d[h].x+p[h].x/3,d[h].y+p[h].y/3),m[h]=new jxPoint(d[h].x-p[h].x/
    3,d[h].y-p[h].y/3)):(k[h]=new jxPoint(d[h].x+p[h].x/3,d[h].y+p[h].y/3),m[h]=new jxPoint(d[h+1].x-p[h+1].x/3,d[h+1].y-p[h+1].y/3));for(h in d)h=parseInt(h),0==h&&(e="M"+d[h].x+","+d[h].y),h<d.length-1&&(e=e+" C"+Math.round(k[h].x)+","+Math.round(k[h].y)+","+Math.round(m[h].x)+","+Math.round(m[h].y)+","+Math.round(d[h+1].x)+","+Math.round(d[h+1].y))}else 4==d.length?e=" M"+d[0].x+","+d[0].y+" C"+d[1].x+","+d[1].y+" "+d[2].x+","+d[2].y+" "+d[3].x+","+d[3].y:3==d.length&&(jsDraw2DX._isVML?(e=new jxPoint(2/
    3*d[1].x+1/3*d[0].x,2/3*d[1].y+1/3*d[0].y),p=new jxPoint(2/3*d[1].x+1/3*d[2].x,2/3*d[1].y+1/3*d[2].y),e=" M"+d[0].x+","+d[0].y+" C"+Math.round(e.x)+","+Math.round(e.y)+" "+Math.round(p.x)+","+Math.round(p.y)+" "+d[2].x+","+d[2].y):e=" M"+d[0].x+","+d[0].y+" Q"+d[1].x+","+d[1].y+" "+d[2].x+","+d[2].y);a.style.display="none";jsDraw2DX._isVML?(d=f.getVML(),c&&(d.appendChild(a),c=!1),e+=" E",this.pen?this.pen.updateVML(a):a.Stroked="False",d=a.fill,this.brush?this.brush.updateVML(d):d.On="false",a.style.position=
    "absolute",a.style.width=1,a.style.height=1,a.CoordSize="1 1",a.Path=e):(d=f.getSVG(),c&&(d.appendChild(a),c=!1),this.pen?this.pen.updateSVG(a):a.setAttribute("stroke","none"),this.brush?this.brush.updateSVG(a,f.getDefs()):a.setAttribute("fill","none"),a.setAttribute("d",e));a.style.display="";b&&f!=b&&b.removeShape(this);b=f;b.addShape(this)};this.remove=function(){b&&(jsDraw2DX._isVML?b.getVML().removeChild(a):b.getSVG().removeChild(a),b.removeShape(this),b=null,c=!0)};this.show=function(){a.style.display=
    ""};this.hide=function(){a.style.display="none"}}
function jxFunctionGraph(e,k,m,a,c){this.fn=e;this.xMin=k;this.xMax=m;this.brush=this.pen=null;var b,f=!0,d;a&&(this.pen=a);c&&(this.brush=c);b=jsDraw2DX._isVML?document.createElement("v:shape"):document.createElementNS("http://www.w3.org/2000/svg","path");this.getType=function(){return"jxFunctionGraph"};this.addEventListener=function(a,d){function c(a){d(a,f)}b.addEventListener?b.addEventListener(a,c,!1):b.attachEvent&&b.attachEvent("on"+a,c);var f=this};this.validate=function(a){a=a.replace(/x/g,
    1);with(Math)try{return eval(a),!0}catch(p){return!1}};this.draw=function(a){var c=[],l,B;B=[];var v=[],n=[];if(this.validate(e)){var g,h,r=0;for(g=k;g<m;g++){with(Math)h=eval(e.replace(/x/g,g));c[r]=a.logicalToPhysicalPoint(new jxPoint(g,h));r++}with(Math)h=eval(e.replace(/x/g,m));c[r]=a.logicalToPhysicalPoint(new jxPoint(g,h));tension=1;for(i in c)i=parseInt(i),B[i]=0==i?new jxPoint(tension*(c[1].x-c[0].x)/2,tension*(c[1].y-c[0].y)/2):i==c.length-1?new jxPoint(tension*(c[i].x-c[i-1].x)/2,tension*
    (c[i].y-c[i-1].y)/2):new jxPoint(tension*(c[i+1].x-c[i-1].x)/2,tension*(c[i+1].y-c[i-1].y)/2);for(i in c)i=parseInt(i),0==i?(v[i]=new jxPoint(c[0].x+B[0].x/3,c[0].y+B[0].y/3),n[i]=new jxPoint(c[1].x-B[1].x/3,c[1].y-B[1].y/3)):i==c.length-1?(v[i]=new jxPoint(c[i].x+B[i].x/3,c[i].y+B[i].y/3),n[i]=new jxPoint(c[i].x-B[i].x/3,c[i].y-B[i].y/3)):(v[i]=new jxPoint(c[i].x+B[i].x/3,c[i].y+B[i].y/3),n[i]=new jxPoint(c[i+1].x-B[i+1].x/3,c[i+1].y-B[i+1].y/3));for(i in c)i=parseInt(i),0==i&&(l="M"+c[i].x+","+
    c[i].y),i<c.length-1&&(l=l+" C"+Math.round(v[i].x)+","+Math.round(v[i].y)+","+Math.round(n[i].x)+","+Math.round(n[i].y)+","+Math.round(c[i+1].x)+","+Math.round(c[i+1].y));b.style.display="none";jsDraw2DX._isVML?(c=a.getVML(),f&&(c.appendChild(b),f=!1),l+=" E",this.pen?this.pen.updateVML(b):b.Stroked="False",c=b.fill,this.brush?this.brush.updateVML(c):c.On="false",b.style.position="absolute",b.style.width=1,b.style.height=1,b.CoordSize="1 1",b.Path=l):(c=a.getSVG(),f&&(c.appendChild(b),f=!1),this.pen?
    this.pen.updateSVG(b):b.setAttribute("stroke","none"),this.brush?this.brush.updateSVG(b,a.getDefs()):b.setAttribute("fill","none"),b.setAttribute("d",l));b.style.display="";d&&a!=d&&d.removeShape(this);d=a;d.addShape(this)}};this.remove=function(){d&&(jsDraw2DX._isVML?d.getVML().removeChild(b):d.getSVG().removeChild(b),d.removeShape(this),d=null,f=!0)};this.show=function(){b.style.display=""};this.hide=function(){b.style.display="none"}}
function jxText(e,k,m,a,c,b){this.point=e;this.text=k;this.brush=this.pen=this.font=null;this.angle=0;var f,d=!0,l;this.getElement=function(){return f};m&&(this.font=m);a&&(this.pen=a);c&&(this.brush=c);b&&(this.angle=b);f=jsDraw2DX._isVML?document.createElement("v:shape"):document.createElementNS("http://www.w3.org/2000/svg","text");this.getsvgvmlOjb=function(){return f};this.getType=function(){return"jxText"};this.addEventListener=function(a,d){function b(a){d(a,c)}f.addEventListener?f.addEventListener(a,
    b,!1):f.attachEvent&&f.attachEvent("on"+a,b);var c=this};this.draw=function(a){var b;b=a.logicalToPhysicalPoint(this.point);var c;c=b.x;b=b.y;f.style.display="none";if(jsDraw2DX._isVML){var e=a.getVML(),k;d&&(k=document.createElement("v:textpath"),k.On="True",k.style["v-text-align"]="left",f.appendChild(k),e.appendChild(f),d=!1);k=f.firstChild;this.pen?this.pen.updateVML(f):f.Stroked="False";e=f.fill;this.brush?this.brush.updateVML(e):e.On="false";f.style.position="absolute";f.style.height=1;f.CoordSize=
    "1 1";e=f.Path;e.TextPathOk="true";e.v="M"+c+","+b+" L"+(c+100)+","+b+" E";k.String=this.text;this.font?this.font.updateVML(k):jxFont.updateVML(k);f.style.display="";k=f.clientHeight/2*.8;e=this.angle;c=Math.round(c+k*Math.sin(e*Math.PI/180));b=Math.round(b-k*Math.cos(e*Math.PI/180));f.Path="M"+c+","+b+" L"+Math.round(c+100*Math.cos(e*Math.PI/180))+","+Math.round(b+100*Math.sin(e*Math.PI/180))+" E";f.style.width=1}else k=a.getSVG(),d&&(k.appendChild(f),d=!1),this.pen?this.pen.updateSVG(f,this):f.setAttribute("stroke",
    "none"),this.brush?this.brush.updateSVG(f,a.getDefs()):f.setAttribute("fill","none"),this.font?this.font.updateSVG(f):jxFont.updateSVG(f),f.setAttribute("x",c),f.setAttribute("y",b),f.setAttribute("transform","rotate("+this.angle+" "+c+","+b+")"),f.textContent=this.text;f.style.display="";l&&a!=l&&l.removeShape(this);l=a;l.addShape(this)};this.remove=function(){l&&(jsDraw2DX._isVML?l.getVML().removeChild(f):l.getSVG().removeChild(f),l.removeShape(this),l=null,d=!0)};this.show=function(){f.style.display=
    ""};this.hide=function(){f.style.display="none"}}
function jxImage(e,k,m,a,c){this.point=e;this.url=k;this.width=m;this.height=a;this.angle=0;var b,f=!0,d;c&&(this.angle=c);b=jsDraw2DX._isVML?document.createElement("v:image"):document.createElementNS("http://www.w3.org/2000/svg","image");this.getType=function(){return"jxImage"};this.addEventListener=function(a,d){function c(a){d(a,e)}b.addEventListener?b.addEventListener(a,c,!1):b.attachEvent&&b.attachEvent("on"+a,c);var e=this};this.draw=function(a){var c,e;c=a.logicalToPhysicalPoint(this.point);
    e=a.scale;var m,l;m=c.x;l=c.y;b.style.display="none";if(jsDraw2DX._isVML){with(Math){var n,g=this.angle,h=this.angle*PI/180,r;c=e*this.width;r=e*this.height;e=m;n=l;360<abs(g)&&(g%=360);0>g&&(g=360+g);0<=g&&90>g?(n=l,e=m-r*sin(h)):90<=g&&180>g?(n=l-r*sin(h-PI/2),e=m-(c*sin(h-PI/2)+r*cos(h-PI/2))):180<=g&&270>g?(n=l-(c*sin(h-PI)+r*cos(h-PI)),e=m-c*cos(h-PI)):270<=g&&360>=g&&(e=m,n=l-c*cos(h-1.5*PI));m=cos(h);l=-sin(h);g=sin(h);h=cos(h)}var t=a.getVML();f&&(t.appendChild(b),f=!1);b.style.width=c;b.style.height=
        r;b.style.position="absolute";b.style.top=n;b.style.left=e;b.style.filter="progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand',M11="+m+",M12="+l+",M21="+g+",M22="+h+") filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+k+"', sizingMethod='scale');"}else c=a.getSVG(),f&&(c.appendChild(b),f=!1),b.setAttribute("x",m),b.setAttribute("y",l),b.setAttribute("height",e*this.height),b.setAttribute("width",e*this.width),b.setAttribute("preserveAspectRatio","none"),b.setAttributeNS("http://www.w3.org/1999/xlink",
        "href",this.url),b.setAttribute("transform","rotate("+this.angle+" "+m+","+l+")");b.style.display="";d&&a!=d&&d.removeShape(this);d=a;d.addShape(this)};this.remove=function(){d&&(jsDraw2DX._isVML?d.getVML().removeChild(b):d.getSVG().removeChild(b),d.removeShape(this),d=null,f=!0)};this.show=function(){b.style.display=""};this.hide=function(){b.style.display="none"}}
function WFEdit(e){function k(a,b,c){function d(a,b){v&&l(b.node);J=b==z||b==A||b==u?!k.readonly:!1;q=null!==h&&h==b&&0!=H;if(c.onNodeClick)c.onNodeClick(a,b.node)}function e(a,b){q=J=!1}function f(a,b){if(c.onNodeDBClick)c.onNodeDBClick(a,b.node)}function g(a,b){if(b==D&!q){a=w(a);var c=b.node.getData();b.getElement().style.cursor="default";H=0;3>=c.left+c.width-a.x&&(3>=c.top+20+c.height-a.y?(b.getElement().style.cursor="nw-resize",H=3):(b.getElement().style.cursor="e-resize",H=1));3>=c.top+c.height-
a.y&&(3>=c.left+c.width-a.x?(b.getElement().style.cursor="nw-resize",H=3):(b.getElement().style.cursor="n-resize",H=2));h=0!=H?b:null}}this.isActive=!1;this.getData=function(){return b};var k=a;this.owner=k;var m="\u8282\u70b9\u540d\u79f0";this.title=function(){return m};this.nodeType=function(){return 1==b.isbegin?1:1==b.isend?2:3};var z,A,D,u,p,E=[];this.setzIndex=function(a){if(a){z&&z.getElement&&(z.getElement().style.zIndex=a);A&&A.getElement&&(A.getElement().style.zIndex=a);D&&D.getElement&&
(D.getElement().style.zIndex=a);u&&u.getElement&&(u.getElement().style.zIndex=a);p&&p.getElement()&&(p.getElement().style.zIndex=a);for(var b=0;b<E.length;b++)E[b].txt&&E[b].txt.getElement&&(E[b].txt.getElement().style.zIndex=a)}};this.clearUser=function(){for(var a=0;a<E.length;a++)E[a].txt.remove();E=[]};this.x=function(){return parseInt(b.left)};this.y=function(){return parseInt(b.top)};this.w=function(){return parseInt(b.width)};this.h=function(){return parseInt(b.height)};this.setData=function(a){a&&
(b=a);this.draw()};this.draw=function(){this.clearUser();b.title&&(m=b.title);var c=0;b.left&&(c=parseInt(b.left));var k=0;b.top&&(k=parseInt(b.top));var h=100;b.width&&(h=parseInt(b.width));var l=150;b.height&&(l=parseInt(b.height));b.left=c;b.top=k;b.width=h;b.height=l;var n;n=this.isActive?L:b.stated&&3==b.stated?M:N;if(this.nodeType()==a.ntp_Normal){if(z)z.point=new jxPoint(c,k),z.width=h,z.height=25,z.pen=n;else{z=new jxRect(new jxPoint(c,k),h,25,n,O);var q=z.getElement();q.setAttribute("cursor",
    "move");q.style.cursor="move";z.node=this;z.addEventListener("mousedown",d);z.addEventListener("mouseup",e);z.addEventListener("dblclick",f);z.addEventListener("mousemove",g)}D?(D.point=new jxPoint(c,k+25),D.width=h,D.height=l-25,D.pen=n):(D=new jxRect(new jxPoint(c,k+25),h,l-25,n,K),D.getElement(),D.node=this,D.addEventListener("mousedown",d),D.addEventListener("mouseup",e),D.addEventListener("dblclick",f),D.addEventListener("mousemove",g));n=new jxFont("sans-serif");n.size=12;n.weight="bold";l=
    B(12,m);h=c+h/2-l.w/2;q=k+12.5+l.h/2;h<c&&(h=c);q<k&&(q=k);h=new jxPoint(h,q);A?(A.point=h,A.text=m):(A=new jxText(h,m,n,null,new jxBrush(new jxColor)),q=A.getElement(),q.setAttribute("cursor","move"),q.style.cursor="move",A.node=this,A.addEventListener("mousedown",d),A.addEventListener("mouseup",e),A.addEventListener("dblclick",f));z.draw(F);D.draw(F);A.draw(F);n=new jxFont("sans-serif");n.size=12;var r;if(b.users)for(q=0;q<b.users.length;q++)E[q]||(E[q]={}),h=new jxPoint(c+5,k+25+(q+1)*(l.h+5.8)-
    .5),r=b.users[q],E[q].txt?(r=E[q].txt,r.point=h):(r=new jxText(h,r.username,n,null,new jxBrush(new jxColor)),r.addEventListener("mousedown",d),r.addEventListener("mouseup",e),r.addEventListener("dblclick",f),r.node=this,E[q].txt=r),r.draw(F)}else if(this.nodeType()==a.ntp_Begin||this.nodeType()==a.ntp_End)q=this.nodeType()==a.ntp_Begin?"\u5f00\u59cb":"\u7ed3\u675f",r=new jxPoint(c+h/2,k+l/2),u?(u.center=r,u.radius=40,u.pen=n):(u=new jxCircle(r,40,n,K),u.node=this,u.addEventListener("mousedown",d),
    u.addEventListener("mouseup",e),u.addEventListener("dblclick",f),u.addEventListener("mousemove",g)),u.draw(F),n=new jxFont("sans-serif"),n.size=12,n.weight="bold",r=new jxPoint(c+h/2-10,k+l/2+5),p?(p.point=r,p.text=q):(p=new jxText(r,q,n,null,new jxBrush(new jxColor)),p.node=this,p.addEventListener("mousedown",d),p.addEventListener("mouseup",e),p.addEventListener("dblclick",f),p.addEventListener("mousemove",g)),p.draw(F)};this.draw();this.remove=function(){if(this.nodeType()!=a.ntp_Normal)alert("\u9996\u5c3e\u8282\u70b9\u4e0d\u5141\u8bb8\u5220\u9664");
else{if(E)for(var b=0;b<E.length;b++)E[b].txt&&E[b].txt.remove();E=null;z&&z.remove();A&&A.remove();D&&D.remove();for(b=r.length-1;0<=b;b--)if(r[b]==this){r.splice(b,1);break}this==n&&(n=void 0);for(var c=this.getLineFromMe(),b=c.length-1;0<=b;b--)c[b].remove();c=this.getLineToMe();for(b=c.length-1;0<=b;b--)c[b].remove()}};this.getLineFromMe=function(){for(var a=[],b=0;b<t.length;b++)t[b].fnode==this&&a.push(t[b]);return a};this.getLineToMe=function(){for(var a=[],b=0;b<t.length;b++)t[b].tnode==this&&
a.push(t[b]);return a};this.getNextNodes=function(){for(var a=[],b=this.getLineFromMe(),c=0;c<b.length;c++)a.push(b[c].tnode);return a};this.getPerNodes=function(){for(var a=[],b=this.getLineToMe(),c=0;c<b.length;c++)a.push(b[c].fnode);return a}}function m(a,b,d,f){function h(a,b){v&&p(b.line);if(e.onLineClick)e.onLineClick(a,b.line)}function k(a,b){}function m(a,b){if(e.onLineDBClick)e.onLineDBClick(a,b.line)}c(d,f);var l=b;this.isActive=!1;this.getData=function(){return l};this.setData=function(a){z&&
z.remove();n&&n.remove();l=a};this.owner=a;this.fnode=d;this.tnode=f;this.title=l.title;var z,n;this.sendTop=function(){var a=jsDraw2DX._isVML?F.getVML():F.getSVG();n&&$(n.getElement()).appendTo(a);z&&$(z.getElement()).appendTo(a)};this.setzIndex=function(a){z&&(z.getElement().style.zIndex=a);n&&(n.getElement().style.zIndex=a)};var q=0;this.getLineMaxY=function(){return q};this.draw=function(){var b=d.getData(),c=f.getData(),b=new jxPoint(parseInt(b.left)+parseInt(b.width),parseInt(b.top)+parseInt(b.height)/
    2),c=new jxPoint(parseInt(c.left),parseInt(c.top)+parseInt(c.height)/2),e,g=d.getData(),A=f.getData();e=new jxPoint(parseInt(g.left)+parseInt(g.width),parseInt(g.top)+parseInt(g.height)/2);var p=new jxPoint(parseInt(A.left),parseInt(A.top)+parseInt(A.height)/2),u=(p.x-e.x)/4,u=20<Math.abs(u)?20:Math.abs(u),r=e.x+u,u=p.x-u,t,g=parseInt(g.top),A=parseInt(A.top)+parseInt(A.height);t=g=A=g+(A-g)/2;for(var v=0;v<a.nodes().length;v++){var w=a.nodes()[v],C=w.getData();w!=d&&w!=f&&parseInt(C.left)+parseInt(C.width)>
r&&parseInt(C.left)<u&&(w=parseInt(C.top),g=w<g?w:g,C=parseInt(C.top)+parseInt(C.height),t=C>t?C:t)}g!=A&&(g-=50);t!=A&&(t+=50);0>g&&(g=-99999);t=Math.abs(t-A)>Math.abs(A-g)?g:t;g=new jxPoint(r,e.y);r=new jxPoint(r,t);A=new jxPoint(u,t);u=new jxPoint(u,p.y);e=e.y>t?e.y:t;q=e=e>p.y?e:p.y;p=Math.sqrt((c.y-u.y)*(c.y-u.y)+(c.x-u.x)*(c.x-u.x));0<p&&(e=c.x+7*(u.x-c.x-(u.y-c.y)/2)/p,t=c.y+7*(u.y-c.y+(u.x-c.x)/2)/p,p=new jxPoint(c.x+7*(u.x-c.x+(u.y-c.y)/2)/p,c.y+7*(u.y-c.y-(u.x-c.x)/2)/p),t=new jxPoint(e,
    t),e=[],e.push(b),e.push(g),e.push(r),e.push(A),e.push(u),e.push(c),e.push(t),e.push(c),e.push(p),e.push(c),e.push(u),e.push(A),e.push(r),e.push(g),b=this.isActive?new jxPen(new jxColor("red"),2):new jxPen(new jxColor("#5CB3E7"),2),z?(z.points=e,z.pen=b):(z=new jxPolyline(e,b,new jxBrush(new jxColor("#FFFFFF"))),z.line=this,z.addEventListener("mousedown",h),z.addEventListener("mouseup",k),z.addEventListener("dblclick",m)),z.draw(F),l.title&&0<l.title.length&&(b=B(12,l.title),b=new jxPoint(r.x+(A.x-
    r.x-b.w)/2,A.y-b.h/2),c=this.isActive?new jxColor("red"):new jxColor,c=new jxBrush(c),n?(n.point=b,n.brush=c,n.text=l.title):(p=new jxFont("sans-serif"),p.size=12,n=new jxText(b,l.title,p,null,c),n.addEventListener("mousedown",h),n.addEventListener("mouseup",k),n.addEventListener("dblclick",m),n.line=this),n.draw(F)))};this.draw();this.remove=function(){z&&z.remove();n&&n.remove();for(var a=0;a<t.length;a++)if(this==t[a]){t.splice(a,1);break}this==g&&(g=void 0)}}function a(){for(var a=0;a<r.length;a++)if(1==
    r[a].nodeType())return r[a];return null}function c(a,b){for(var c=0;c<t.length;c++)if(t[c].fnode==a&&t[c].fnode==b)return t[c];return null}function b(a){for(var b=a.getLineFromMe(),c=0;c<b.length;c++)b[c].draw();a=a.getLineToMe();for(c=0;c<a.length;c++)a[c].draw()}function f(){for(var a=!1,b=0,c=0,d=0;d<r.length;d++){var e=r[d],f=e.getLineToMe().length,g=e.getLineFromMe().length;if(1==e.nodeType()){b++;if(0!==f)return alert(e.title+"\u5934\u8282\u70b9\u6709\u524d\u7f6e\u8282\u70b9\uff1a"+f),0;if(0==
    g)return alert("\u5934\u8282\u70b9\u65e0\u540e\u7f6e\u8282\u70b9"),0}else if(2==e.nodeType()){c++;if(0!==g)return alert("\u5c3e\u8282\u70b9\u6709\u540e\u7f6e\u8282\u70b9"),0;if(0==f)return alert("\u5c3e\u8282\u70b9\u65e0\u524d\u7f6e\u8282\u70b9"),0}else{if(0==f||0==g)return alert("\u65e0\u524d\u7f6e\u6216\u540e\u7f6e\u7ed3\u70b9"),0;1<g&&1<g&&(a=!0)}}return 1!=b||1!=c?0:a?2:1}function d(){for(var a,b,c=a=b=0;c<r.length;c++){var d=r[c].x()+r[c].w();a<d&&(a=d);d=r[c].y()+r[c].h();b<d&&(b=d)}for(c=0;c<
t.length;c++)d=t[c],b<d.getLineMaxY()&&(b=d.getLineMaxY());G.style.width=a<C.clientWidth?C.clientWidth+"px":a+"px";G.style.height=b<C.clientHeight?parseInt(C.clientHeight)+20+"px":parseInt(b)+20+"px";jsDraw2DX._isVML||(b=F.getSVG(),b.style.width=G.style.width,b.style.height=G.style.height);n&&(b=n.x()+n.w(),a=n.y()+n.h(),c=C.clientWidth,d=C.clientHeight,b>c&&(C.scrollLeft=b-c),a>d&&(C.scrollTop=a-d))}function l(a){n&&(n.isActive=!1,n.draw(),n=void 0);a&&(p(void 0),n=a,n.isActive=!0,n.draw())}function p(a){g&&
(g.isActive=!1,g.draw(),g=void 0);a&&(l(void 0),g=a,g.isActive=!0,g.draw(),g.sendTop())}function w(a){document.all?(mouseX=event.clientX+C.scrollLeft+document.body.parentElement.scrollLeft,mouseY=event.clientY+C.scrollTop+document.body.parentElement.scrollTop):(mouseX=a.pageX+C.scrollLeft,mouseY=a.pageY+C.scrollTop);0>mouseX&&(mouseX=0);0>mouseY&&(mouseY=0);mouseX-=C.getBoundingClientRect().left;mouseY-=C.getBoundingClientRect().top;return{x:mouseX,y:mouseY}}function B(a,b){0==$("#divctstrlh").length&&
$("<div id='divctstrlh' style='position:absolute;visibility:hidden;padding: 0px;margin: 0px'></div>").appendTo("body");$("#divctstrlh").css({fontSize:a+"px","line-height":a+"px"});$("#divctstrlh").html(b);a=$("#divctstrlh")[0];return{h:a.offsetHeight,w:a.offsetWidth}}this.ntp_Begin=1;this.ntp_End=2;this.ntp_Normal=3;var v=void 0==e.activeOnClick?!0:e.activeOnClick;this.nodes=function(){return r};this.lines=function(){return t};this.readonly=!1;this.getData=function(){for(var a=[],b=[],c=0;c<t.length;c++){var d=
    t[c];if(e.onGetLineData)e.onGetLineData(d);b.push(t[c].getData())}for(c=0;c<r.length;c++)a.push(r[c].getData());return{procs:a,lines:b}};var n=void 0,g=void 0,h=void 0;this.getActiveNode=function(){return n};this.getActiveLine=function(){return g};var r=[],t=[],J=!1,q=!1,H=0,N=new jxPen(new jxColor("#5CB3E7"),1),L=new jxPen(new jxColor("red"),1),M=new jxPen(new jxColor("#387F00"),1),O=new jxBrush(new jxColor("#DBEAFC")),K=new jxBrush(new jxColor("white")),I,C=e.el;C?C.style.overflow="auto":C=document.body;
    var G=document.createElement("div");C.appendChild(G);G.style.left="0px";G.style.top="0px";G.style.width=C.clientWidth+"px";G.style.height=C.clientHeight+"px";G.onmousemove=function(a,c){v&&(c=!1,I=w(a),J&&n&&(a=n.getData(),a.left=I.x-a.width/2,3==n.nodeType()?a.top=I.y-15:a.top=I.y-a.height/3,0>a.left&&(a.left=0),0>a.top&&(a.top=0),c=!0,b(n),n.draw()),q&void 0!=n&0!=H&&(a=n.getData(),1==H&&(a.width=I.x-a.left+1),2==H&&(a.height=I.y-a.top+1),3==H&&(a.width=I.x-a.left+1,a.height=I.y-a.top+1),50>a.width&&
    (a.width=50),80>a.height&&(a.height=80),c=!0,b(n),n.draw()),c&&d())};var F=new jxGraphics(G);this.addNode=function(a){a=new k(this,a,e);r.push(a);return a};this.removeNode=function(a){a.remove();a==n&&(n=null)};this.addLine=function(a,b,c){a=new m(this,a,b,c);a:{for(b=0;b<t.length;b++)if(a==t[b]){b=t[b];break a}b=null}b||t.push(a);return a};this.removeLine=function(a){a.remove()};this.removeall=function(){F.removeall();r=[];t=[];h=g=n=void 0};this.initBEnodes=function(){this.removeall();var a={left:10,
        top:10,width:100,height:150,title:"\u5f00\u59cb",isbegin:1,isend:2};this.addNode(a);a={left:G.clientWidth-100-20,top:10,width:100,height:150,title:"\u7ed3\u675f",isend:1,isbegin:2};this.addNode(a)};e.initBENodes&&this.initBEnodes();this.getHeadNode=a;this.getEndNode=function(){for(var a=0;a<r.length;a++)if(r[a].nodeType()==this.ntp_End)return r[a];return null};this.checkWF=f;this.autoSortUI=function(){var b=f();if(0!=b)if(2==b)alert("\u975e\u94fe\u8868\u6d41\u7a0b\u4e0d\u80fd\u81ea\u52a8\u6392\u5e8f");
    else if(1==b){var c=a();if(null==c)alert("\u672a\u53d1\u73b0\u5934\u7ed3\u70b9");else{for(b=pw=0;;){var d=c.getData();d.left=b+pw+30;d.top=50;b=c.x();pw=c.w();c.draw();c=c.getNextNodes();if(1!=c.length)break;else c=c[0]}for(b=0;b<t.length;b++)t[b].draw()}}};this.reSetScroll=d;this.setActiveNode=l};