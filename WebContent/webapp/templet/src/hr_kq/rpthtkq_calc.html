<!DOCTYPE html>
<html workpath="webapp/hr_kq">
<head lang="zh">
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="../js/easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="../js/easyui/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="../js/css/corsair.css">
    <link rel="stylesheet" type="text/css" href="../style/jquery.jOrgChart.css">
    <link rel="stylesheet" type="text/css" href="../style/custom.css">


    <script type="text/javascript" src="../js/easyui/jquery.min.js"></script>
    <script type="text/javascript" src="../js/easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../js/easyui/easyloader.js"></script>

    <!--[if lte IE 8]>
    <script language="javascript" type="text/javascript" src="../js/flot/excanvas.min.js"></script>
    <![endif]-->
    <script type="text/javascript" src="../js/flot/jquery.flot.js"></script>
    <script type="text/javascript" src="../js/flot/jquery.flot.pie.js"></script>
    <script type="text/javascript" src="../js/flot/jquery.flot.axislabels.js"></script>
    <script type="text/javascript" src="../js/flot/jquery.flot.stack.js"></script>
    <script type="text/javascript" src="../js/flot/jshashtable-2.1.js"></script>
    <script type="text/javascript" src="../js/flot/jquery.numberformatter-1.2.3.min.js"></script>
    <script type="text/javascript" src="../js/flot/jquery.flot.time.js"></script>
    <script type="text/javascript" src="../js/flot/jquery.flot.symbol.js"></script>
    <script type="text/javascript" src="../js/flot/jquery.flot.resize.js"></script>

    <script type="text/javascript" src="../js/cjquery.min.js"></script>
    <script type="text/javascript" src="../js/icefall.min.js"></script>
    <script type="text/javascript" src="../js/common/jsonbanding.min.js"></script>
    <script type="text/javascript" src="../js/common/cSearchDlg.min.js"></script>
    <script type="text/javascript" src="../js/common/cFindDlg.min.js"></script>
    <script type="text/javascript" src="../js/common/creport.js"></script>
    <script type="text/javascript" src="../js/otherjs/html2canvas.min.js"></script>
    <title></title>
    <script type="text/javascript" style="cserver_js">
        var comUrls = [
            {
                index: "dic5",
                type: "combobox",
                url: "/web/dict/getdictvalues.co?dicid=5",
                valueField: 'dictvalue',
                textField: 'language1'
            },
            {
                index: "dic968",
                type: "combobox",
                url: "/web/dict/getdictvalues.co?dicid=968",
                valueField: 'dictvalue',
                textField: 'language1'
            },
            {
                index: "dic1240",
                type: "combobox",
                url: "/web/dict/getdictvalues.co?dicid=1240",
                valueField: 'dictvalue',
                textField: 'language1'
            }
        ];
    </script>
    <script type="text/javascript">
        var listGridColumns = function () {
            return [[
                {field: 'ym', title: '考勤年月', rowspan: 2, width: 80, formatter: $fieldDateFormatorYYYY_MM},
                {field: 'kqdate', title: '考勤日期', rowspan: 2, width: 80, formatter: $fieldDateFormatorYYYY_MM_DD},
                {field: 'employee_code', title: '工号', rowspan: 2, width: 64},
                {field: 'employee_name', title: '姓名', rowspan: 2, width: 80},
                {field: 'scdname', title: '班制', rowspan: 2, width: 64},
                {field: 'bcno', title: '班次号', rowspan: 2, width: 50},
                {field: 'orgname', title: '机构', rowspan: 2, width: 150},
                {field: 'sp_name', title: '职位', rowspan: 2, width: 80},
                {field: 'lv_num', title: '职级', rowspan: 2, width: 50},
                {title: '上班', colspan: 4, width: 200},
                {title: '下班', colspan: 4, width: 200},
                {field: 'lrst', title: '班次考勤结果', rowspan: 2, width: 80, formatter: comUrl_dic1240.formator},
                {field: 'isabnom', title: '是否异常', rowspan: 2, width: 64, formatter: comUrl_dic5.formator}],
                [
                    {field: 'frtime', title: '上班时间', width: 64},
                    {field: 'frsktime', title: '打卡时间', width: 64},
                    {field: 'mtslate', title: '迟到时长', width: 64},
                    {field: 'frst', title: '计算结果', width: 64, formatter: comUrl_dic968.formator},
                    {field: 'totime', title: '下班时间', width: 64},
                    {field: 'tosktime', title: '打卡时间', width: 64},
                    {field: 'mtslearly', title: '早退时长', width: 64},
                    {field: 'trst', title: '计算结果', width: 64, formatter: comUrl_dic968.formator}]
            ]
        };


        var findExtParms = [
            {field: 'ym', title: '考勤年月', rowspan: 2, width: 80, formatter: $fieldDateFormatorYYYY_MM},
            {field: 'kqdate', title: '考勤日期', width: 64, formatter: $fieldDateFormatorYYYY_MM_DD},
            {field: 'employee_code', title: '工号', width: 64},
            {field: 'employee_name', title: '姓名', width: 64},
            {field: 'scdname', title: '班制', width: 64},
            {field: 'bcno', title: '班次号', width: 64},
            {field: 'orgname', title: '机构', width: 64},
            {field: 'sp_name', title: '职位', width: 64},
            {field: 'lv_num', title: '职级', width: 64},
            {field: 'frtime', title: '上班时间', width: 64},
            {field: 'frsktime', title: '打卡时间', width: 64},
            {field: 'mtslate', title: '迟到时长', width: 64},
            {field: 'frst', title: '上班计算结果', width: 64, formatter: comUrl_dic968.formator},
            {field: 'totime', title: '下班时间', width: 64},
            {field: 'tosktime', title: '打卡时间', width: 64},
            {field: 'mtslearly', title: '早退时长', width: 64},
            {field: 'trst', title: '下班计算结果', width: 64, formatter: comUrl_dic968.formator},
            {field: 'isabnom', title: '是否异常', width: 64, formatter: comUrl_dic5.formator}
        ];

        var prtOptions = {
            htmlTempt: "",
            findwidth: "400px",//
            findheight: "400px",//
            gdListColumns: listGridColumns,
            findExtParms: findExtParms,
            coURL: _serUrl + "/web/hrkq/rpt1/findkqcalcrst.co",
            afterInitUI: function () {
                //var hts = "<a id='id_bt_calc' href='#' class='easyui-menubutton' data-options='menu:\"#calcmenu\"'>考勤计算</a>";
                //$(hts).insertBefore($("#id_bt_find"));
            }
        };
    </script>
</head>
<body>
</body>
</html>